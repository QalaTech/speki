{
    "projectName": "Component Deduplication and Reviewer Agent",
    "branchName": "ralph/dedup-versions",
    "description": "Enhance the existing dedup review flow with cross-repo search, identity promotion, aggregation summaries, and aligned versioning semantics",
    "userStories": [
        {
            "id": "US-001",
            "title": "Add SecuritySummary value object to Domain",
            "description": "Create the SecuritySummary value object in the Registry Domain layer to represent aggregated security information across all discoveries for a component",
            "acceptanceCriteria": [
                "SecuritySummary is a sealed record in Continuum.Registry.Domain",
                "Contains properties: OverallRating (string), AuthMethods (IReadOnlyList<string>), Concerns (IReadOnlyList<string>), DiscoveryCount (int)",
                "Uses file-scoped namespace",
                "All properties use required keyword or init-only as appropriate",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 1,
            "passes": false,
            "notes": "This is a new JSONB-serializable value object for Component aggregated security",
            "dependencies": []
        },
        {
            "id": "US-002",
            "title": "Add SemanticSummary value object to Domain",
            "description": "Create the SemanticSummary value object in the Registry Domain layer to represent aggregated semantic information across all discoveries for a component",
            "acceptanceCriteria": [
                "SemanticSummary is a sealed record in Continuum.Registry.Domain",
                "Contains properties: Description (string), Domains (IReadOnlyList<string>), UseCases (IReadOnlyList<string>), Criticality (string), DiscoveryCount (int)",
                "Uses file-scoped namespace",
                "All properties use required keyword or init-only as appropriate",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 2,
            "passes": false,
            "notes": "This is a new JSONB-serializable value object for Component aggregated semantics",
            "dependencies": []
        },
        {
            "id": "US-003",
            "title": "Add SecuritySummary and SemanticSummary properties to Component entity",
            "description": "Extend the Component domain entity to include nullable SecuritySummary and SemanticSummary properties for aggregated data",
            "acceptanceCriteria": [
                "Component entity has SecuritySummary property (nullable SecuritySummary type)",
                "Component entity has SemanticSummary property (nullable SemanticSummary type)",
                "Properties have appropriate access modifiers for domain entity pattern",
                "No breaking changes to existing Component functionality",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 3,
            "passes": false,
            "notes": "These replace component-level Security and Semantic per PRD Section 22",
            "dependencies": [
                "US-001",
                "US-002"
            ]
        },
        {
            "id": "US-004",
            "title": "Add per-repo Security value object for ComponentDiscovery",
            "description": "Create a SecurityAssessment value object for per-repository security information on ComponentDiscovery",
            "acceptanceCriteria": [
                "SecurityAssessment is a sealed record in Continuum.Registry.Domain",
                "Contains properties appropriate for per-repo security context (AuthMethod, Credentials, Concerns)",
                "Uses file-scoped namespace",
                "All properties use required keyword or init-only as appropriate",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 4,
            "passes": false,
            "notes": "Per-repo security variability belongs on ComponentDiscovery",
            "dependencies": []
        },
        {
            "id": "US-005",
            "title": "Add per-repo Semantic value object for ComponentDiscovery",
            "description": "Create a SemanticAnalysis value object for per-repository semantic information on ComponentDiscovery",
            "acceptanceCriteria": [
                "SemanticAnalysis is a sealed record in Continuum.Registry.Domain",
                "Contains properties: Purpose (string), Domain (string), DataFlow (string), Criticality (string), SuggestedName (string)",
                "Uses file-scoped namespace",
                "All properties use required keyword or init-only as appropriate",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 5,
            "passes": false,
            "notes": "Per-repo semantic context and suggestedName belong on ComponentDiscovery",
            "dependencies": []
        },
        {
            "id": "US-006",
            "title": "Add Security and Semantic properties to ComponentDiscovery entity",
            "description": "Extend the ComponentDiscovery domain entity to include nullable Security and Semantic properties for per-repo data",
            "acceptanceCriteria": [
                "ComponentDiscovery entity has Security property (nullable SecurityAssessment type)",
                "ComponentDiscovery entity has Semantic property (nullable SemanticAnalysis type)",
                "Properties have appropriate access modifiers for domain entity pattern",
                "No breaking changes to existing ComponentDiscovery functionality",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 6,
            "passes": false,
            "notes": "Per-repo observations stored on discovery, not component",
            "dependencies": [
                "US-004",
                "US-005"
            ]
        },
        {
            "id": "US-007",
            "title": "Add EF Core configuration for Component summary JSONB columns",
            "description": "Configure EF Core to map SecuritySummary and SemanticSummary as JSONB columns on the Components table",
            "acceptanceCriteria": [
                "ComponentConfiguration maps SecuritySummary as JSONB column",
                "ComponentConfiguration maps SemanticSummary as JSONB column",
                "Columns are nullable",
                "Uses appropriate PostgreSQL JSONB serialization",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 11,
            "passes": false,
            "notes": "Infrastructure layer EF configuration for new Component columns",
            "dependencies": [
                "US-003"
            ]
        },
        {
            "id": "US-008",
            "title": "Add EF Core configuration for ComponentDiscovery JSONB columns",
            "description": "Configure EF Core to map Security and Semantic as JSONB columns on the ComponentDiscoveries table",
            "acceptanceCriteria": [
                "ComponentDiscoveryConfiguration maps Security as JSONB column",
                "ComponentDiscoveryConfiguration maps Semantic as JSONB column",
                "Columns are nullable",
                "Uses appropriate PostgreSQL JSONB serialization",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 12,
            "passes": false,
            "notes": "Infrastructure layer EF configuration for new ComponentDiscovery columns",
            "dependencies": [
                "US-006"
            ]
        },
        {
            "id": "US-009",
            "title": "Create database migration for summary columns",
            "description": "Add EF Core migration to create the new JSONB columns on Components and ComponentDiscoveries tables",
            "acceptanceCriteria": [
                "Migration adds SecuritySummary JSONB column to Components table (nullable)",
                "Migration adds SemanticSummary JSONB column to Components table (nullable)",
                "Migration adds Security JSONB column to ComponentDiscoveries table (nullable)",
                "Migration adds Semantic JSONB column to ComponentDiscoveries table (nullable)",
                "Migration is idempotent and can be rolled back",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 13,
            "passes": false,
            "notes": "Greenfield schema - no backward compatibility needed per PRD Section 22",
            "dependencies": [
                "US-007",
                "US-008"
            ]
        },
        {
            "id": "US-010",
            "title": "Add SecuritySummaryDto to Application layer",
            "description": "Create the SecuritySummaryDto sealed record for API responses",
            "acceptanceCriteria": [
                "SecuritySummaryDto is a sealed record in Application DTOs",
                "Contains properties matching SecuritySummary value object",
                "Uses file-scoped namespace",
                "All properties use init-only setters",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 21,
            "passes": false,
            "notes": "DTO for exposing aggregated security summary in API responses",
            "dependencies": [
                "US-001"
            ]
        },
        {
            "id": "US-011",
            "title": "Add SemanticSummaryDto to Application layer",
            "description": "Create the SemanticSummaryDto sealed record for API responses",
            "acceptanceCriteria": [
                "SemanticSummaryDto is a sealed record in Application DTOs",
                "Contains properties matching SemanticSummary value object",
                "Uses file-scoped namespace",
                "All properties use init-only setters",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 22,
            "passes": false,
            "notes": "DTO for exposing aggregated semantic summary in API responses",
            "dependencies": [
                "US-002"
            ]
        },
        {
            "id": "US-012",
            "title": "Add SecurityAssessmentDto for per-repo security",
            "description": "Create the SecurityAssessmentDto sealed record for per-repo security in ComponentDiscovery responses",
            "acceptanceCriteria": [
                "SecurityAssessmentDto is a sealed record in Application DTOs",
                "Contains properties matching SecurityAssessment value object",
                "Uses file-scoped namespace",
                "All properties use init-only setters",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 23,
            "passes": false,
            "notes": "DTO for per-repo security on ComponentDiscoveryDto",
            "dependencies": [
                "US-004"
            ]
        },
        {
            "id": "US-013",
            "title": "Add SemanticAnalysisDto for per-repo semantic",
            "description": "Create the SemanticAnalysisDto sealed record for per-repo semantic in ComponentDiscovery responses",
            "acceptanceCriteria": [
                "SemanticAnalysisDto is a sealed record in Application DTOs",
                "Contains properties matching SemanticAnalysis value object",
                "Uses file-scoped namespace",
                "All properties use init-only setters",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 24,
            "passes": false,
            "notes": "DTO for per-repo semantic on ComponentDiscoveryDto",
            "dependencies": [
                "US-005"
            ]
        },
        {
            "id": "US-014",
            "title": "Update ComponentDto to include summary DTOs",
            "description": "Extend ComponentDto to include optional SecuritySummaryDto and SemanticSummaryDto properties",
            "acceptanceCriteria": [
                "ComponentDto has SecuritySummary property (nullable SecuritySummaryDto)",
                "ComponentDto has SemanticSummary property (nullable SemanticSummaryDto)",
                "Mapping from Component entity to DTO includes new properties",
                "No breaking changes to existing ComponentDto consumers",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 25,
            "passes": false,
            "notes": "Updates Application layer DTO to expose aggregated summaries",
            "dependencies": [
                "US-010",
                "US-011",
                "US-003"
            ]
        },
        {
            "id": "US-015",
            "title": "Update ComponentDiscoveryDto to include per-repo DTOs",
            "description": "Extend ComponentDiscoveryDto to include optional Security and Semantic properties",
            "acceptanceCriteria": [
                "ComponentDiscoveryDto has Security property (nullable SecurityAssessmentDto)",
                "ComponentDiscoveryDto has Semantic property (nullable SemanticAnalysisDto)",
                "Mapping from ComponentDiscovery entity to DTO includes new properties",
                "No breaking changes to existing ComponentDiscoveryDto consumers",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 26,
            "passes": false,
            "notes": "Updates Application layer DTO to expose per-repo security/semantic",
            "dependencies": [
                "US-012",
                "US-013",
                "US-006"
            ]
        },
        {
            "id": "US-016",
            "title": "Add UpdateComponentSummariesRequest DTO",
            "description": "Create request DTO for updating component summaries via the Aggregation Summary Agent",
            "acceptanceCriteria": [
                "UpdateComponentSummariesRequest is a sealed record in Application DTOs",
                "Contains required Guid ComponentId property",
                "Contains required int RowVersion property for optimistic locking",
                "Contains optional SecuritySummaryDto and SemanticSummaryDto properties",
                "Uses file-scoped namespace",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 27,
            "passes": false,
            "notes": "Request DTO for Aggregation Summary Agent to update Component summaries",
            "dependencies": [
                "US-010",
                "US-011"
            ]
        },
        {
            "id": "US-017",
            "title": "Add IComponentService.UpdateSummariesAsync method",
            "description": "Extend IComponentService interface with method to update component summaries with optimistic concurrency",
            "acceptanceCriteria": [
                "IComponentService has UpdateSummariesAsync method signature",
                "Method accepts UpdateComponentSummariesRequest and CancellationToken",
                "Method returns Task<ComponentDto>",
                "Method signature follows existing service patterns",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 28,
            "passes": false,
            "notes": "Interface method for Aggregation Summary Agent use case",
            "dependencies": [
                "US-016",
                "US-014"
            ]
        },
        {
            "id": "US-018",
            "title": "Implement ComponentService.UpdateSummariesAsync",
            "description": "Implement the UpdateSummariesAsync method in ComponentService with optimistic locking",
            "acceptanceCriteria": [
                "Implementation uses GetByIdForUpdateAsync to fetch with row-level lock",
                "Validates RowVersion matches before update",
                "Throws ConcurrencyConflictException on version mismatch",
                "Updates SecuritySummary and SemanticSummary on Component entity",
                "Increments RowVersion on Component",
                "Uses IUnitOfWork for coordinated save",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 29,
            "passes": false,
            "notes": "Service implementation with concurrency handling per PRD Section 12",
            "dependencies": [
                "US-017"
            ]
        },
        {
            "id": "US-019",
            "title": "Add Component.UpdateSummaries domain method",
            "description": "Add domain method on Component entity to update aggregated summaries with proper encapsulation",
            "acceptanceCriteria": [
                "Component has UpdateSummaries method accepting SecuritySummary and SemanticSummary",
                "Method updates properties and increments RowVersion",
                "Method is the only way to modify summary properties (setter encapsulation)",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 30,
            "passes": false,
            "notes": "Domain entity encapsulation for summary updates",
            "dependencies": [
                "US-003"
            ]
        },
        {
            "id": "US-020",
            "title": "Add GetDiscoveriesForComponent endpoint",
            "description": "Verify or add REST endpoint GET /api/v1/organisations/{orgId}/components/{id}/discoveries that returns all active discoveries for a component",
            "acceptanceCriteria": [
                "Endpoint exists at GET /api/v1/organisations/{orgId}/components/{id}/discoveries",
                "Returns IReadOnlyList<ComponentDiscoveryDto> for all active discoveries",
                "Returns 404 if component not found or doesn't belong to organisation",
                "Includes per-repo Security and Semantic in response DTOs",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 41,
            "passes": false,
            "notes": "Required endpoint that MCP tool GetDiscoveriesForComponent will wrap",
            "dependencies": [
                "US-015"
            ]
        },
        {
            "id": "US-021",
            "title": "Add UpdateComponentSummariesHandler to API",
            "description": "Create minimal API handler for updating component summaries via PUT endpoint",
            "acceptanceCriteria": [
                "UpdateComponentSummariesHandler is a static class in Api Features",
                "Has single Handle method accepting request, service, and CancellationToken",
                "Returns Results.Ok with updated ComponentDto on success",
                "Returns Results.Conflict on ConcurrencyConflictException",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 42,
            "passes": false,
            "notes": "API handler for Aggregation Summary Agent to call",
            "dependencies": [
                "US-018"
            ]
        },
        {
            "id": "US-022",
            "title": "Map UpdateComponentSummaries endpoint",
            "description": "Add route mapping for the UpdateComponentSummaries endpoint in ComponentEndpoints",
            "acceptanceCriteria": [
                "Endpoint mapped at PUT /api/v1/organisations/{orgId}/components/{id}/summaries",
                "Uses MapPut with appropriate route template",
                "Has .WithTags for OpenAPI grouping",
                "Has .WithName for endpoint naming",
                "Has .Produces<ComponentDto> for success response type",
                "Has .ProducesProblem(409) for conflict response",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 43,
            "passes": false,
            "notes": "Endpoint registration for summary updates",
            "dependencies": [
                "US-021"
            ]
        },
        {
            "id": "US-023",
            "title": "Add GetDiscoveriesForComponent MCP tool definition",
            "description": "Define the GetDiscoveriesForComponent MCP tool in Atlas tools/mcp layer for fetching all discoveries for a component",
            "acceptanceCriteria": [
                "Tool definition exists in atlas/src/atlas/tools/mcp",
                "Tool name is GetDiscoveriesForComponent",
                "Tool parameter is componentId (Guid, required)",
                "Tool description explains it returns all active ComponentDiscoveryDto records for org-wide aggregation",
                "Tool wraps the REST endpoint GET /api/v1/organisations/{orgId}/components/{id}/discoveries",
                "All existing tests pass",
                "Build succeeds with no warnings",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 44,
            "passes": false,
            "notes": "Required MCP tool per FR-9 for Aggregation Summary Agent",
            "dependencies": [
                "US-020"
            ]
        },
        {
            "id": "US-024",
            "title": "Add SearchComponents to dedup review toolset",
            "description": "Update the dedup review tool factory to include SearchComponents in the available tools for cross-repo dedup",
            "acceptanceCriteria": [
                "SearchComponents tool is included in dedup_review toolset in tools/factory.py",
                "Tool is available alongside existing ListStagedComponents, ListApprovedComponents, GetComponent",
                "Tool filters are correctly configured for dedup_review context",
                "All existing tests pass",
                "Build succeeds with no warnings",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 45,
            "passes": false,
            "notes": "Enables cross-repo dedup via existing MCP search capability per PRD Section 17",
            "dependencies": []
        },
        {
            "id": "US-025",
            "title": "Create Aggregation Summary Agent definition",
            "description": "Create the new Aggregation Summary Agent in Atlas that runs post-dedup to compute and persist summaries",
            "acceptanceCriteria": [
                "New agent file created at atlas/src/atlas/agents/aggregation_summary.py",
                "Agent has access to GetDiscoveriesForComponent tool",
                "Agent has access to UpdateComponent tool for persisting summaries",
                "Agent is configured for post-dedup execution",
                "Uses file-scoped imports and follows existing agent patterns",
                "All existing tests pass",
                "Build succeeds with no warnings",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 46,
            "passes": false,
            "notes": "New agent per FR-8 that computes SecuritySummary and SemanticSummary",
            "dependencies": [
                "US-023"
            ]
        },
        {
            "id": "US-026",
            "title": "Add aggregation_summary node to graph workflow",
            "description": "Add graph node for Aggregation Summary Agent that runs after dedup_review",
            "acceptanceCriteria": [
                "New node aggregation_summary added to graph workflow",
                "Node executes after dedup_review completes",
                "Node invokes Aggregation Summary Agent with affected component IDs",
                "Node respects Persist vs Preview mode (persist only in Persist mode)",
                "All existing tests pass",
                "Build succeeds with no warnings",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 47,
            "passes": false,
            "notes": "Graph integration for Aggregation Summary Agent post-dedup",
            "dependencies": [
                "US-025"
            ]
        },
        {
            "id": "US-027",
            "title": "Update dedup agent prompt for SearchComponents usage",
            "description": "Update the deduplication agent prompt to use SearchComponents for cross-repo dedup candidates",
            "acceptanceCriteria": [
                "Dedup agent prompt instructs use of SearchComponents with query, keywords, topK parameters",
                "Prompt explains to provide semantic description as query",
                "Prompt explains to provide strong lexical hints as keywords",
                "Prompt clarifies agent relies on search service ranking, not client-side scoring",
                "Prompt instructs agent to provide concise reasoning for each decision",
                "All existing tests pass",
                "Build succeeds with no warnings",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 48,
            "passes": false,
            "notes": "Prompt updates per PRD Section 10 matching guidance",
            "dependencies": [
                "US-024"
            ]
        },
        {
            "id": "US-028",
            "title": "Update dedup agent prompt for identity promotion",
            "description": "Extend dedup agent prompt to handle identity promotion for safe fields under guardrails",
            "acceptanceCriteria": [
                "Prompt includes identity promotion guidance for Name/ServiceName/Tags/Responsibility",
                "Prompt specifies quality rubric for name promotion (not placeholder, reasonable length, vendor normalization)",
                "Prompt instructs to flag high-risk fields (Type/Category/Direction/Classification) for human review",
                "Prompt instructs use of UpdateComponent with rowVersion for safe field updates",
                "Prompt requires logging rationale for each promotion decision",
                "All existing tests pass",
                "Build succeeds with no warnings",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 49,
            "passes": false,
            "notes": "Identity promotion per PRD Section 11 and 11b",
            "dependencies": [
                "US-027"
            ]
        },
        {
            "id": "US-029",
            "title": "Create Aggregation Summary Agent prompt",
            "description": "Create the prompt template for Aggregation Summary Agent with aggregation logic",
            "acceptanceCriteria": [
                "Prompt file created in atlas/src/atlas/llm/prompts for aggregation summary",
                "Prompt instructs fetching all active discoveries via GetDiscoveriesForComponent",
                "Prompt explains SecuritySummary computation (overall rating, auth methods, concerns, discovery count)",
                "Prompt explains SemanticSummary computation (description, domains, use cases, criticality, discovery count)",
                "Prompt instructs use of UpdateComponent with rowVersion for persisting",
                "Prompt handles Persist vs Preview mode distinction",
                "All existing tests pass",
                "Build succeeds with no warnings",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 50,
            "passes": false,
            "notes": "Prompt for Aggregation Summary Agent per PRD Section 9.2.5",
            "dependencies": [
                "US-026"
            ]
        },
        {
            "id": "US-030",
            "title": "Add staged alignment logic to dedup review",
            "description": "Add interim staged alignment step to dedup review for Phase 1 compatibility with current finalize behavior",
            "acceptanceCriteria": [
                "After identity promotion, staged entries are aligned to canonical Component identity",
                "Alignment uses SubmitComponent to re-submit with canonical identity fields",
                "Duplicate staged entries are discarded via DiscardStagedComponent",
                "Detection and per-repo semantic/security preserved in aligned state",
                "Idempotency key is reused or composed appropriately",
                "All existing tests pass",
                "Build succeeds with no warnings",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 51,
            "passes": false,
            "notes": "Phase 1 interim step per PRD Section 9.2.6 until finalize semantics change",
            "dependencies": [
                "US-028"
            ]
        },
        {
            "id": "US-031",
            "title": "Update SnapshotService to snapshot canonical Component into versions",
            "description": "Modify FinalizeSnapshot to create ComponentVersion.State from canonical Component instead of staged.StateJson",
            "acceptanceCriteria": [
                "ProcessPersistSnapshotAsync creates versions from canonical Component for Added/Modified",
                "Version.State includes identity/connection fields and aggregated summaries from Component",
                "Removals continue to use minimal/empty state as before",
                "Component.CurrentVersionId is updated to point to new version",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 52,
            "passes": false,
            "notes": "Core versioning change per PRD Section 23 - versions reflect canonical Component at finalize",
            "dependencies": [
                "US-019",
                "US-018"
            ]
        },
        {
            "id": "US-032",
            "title": "Add ComponentVersionState DTO for version snapshots",
            "description": "Create sealed record DTO representing the state to be serialized into ComponentVersion.State",
            "acceptanceCriteria": [
                "ComponentVersionState is a sealed record in Application DTOs",
                "Contains all identity/connection fields from Component (Type, Category, Direction, Classification, Connection, ServiceName, Name, Responsibility, Tags)",
                "Contains SecuritySummary and SemanticSummary (aggregated at finalize time)",
                "Uses file-scoped namespace",
                "All properties use init-only setters",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 53,
            "passes": false,
            "notes": "DTO defining the structure of ComponentVersion.State JSON",
            "dependencies": [
                "US-010",
                "US-011"
            ]
        },
        {
            "id": "US-033",
            "title": "Add Component to ComponentVersionState mapper",
            "description": "Create mapping logic to convert canonical Component to ComponentVersionState for version serialization",
            "acceptanceCriteria": [
                "Mapper method exists to convert Component entity to ComponentVersionState",
                "All identity/connection fields are mapped correctly",
                "SecuritySummary and SemanticSummary are mapped if present",
                "Mapper is used by SnapshotService during version creation",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 54,
            "passes": false,
            "notes": "Mapping logic for versioning change",
            "dependencies": [
                "US-032",
                "US-031"
            ]
        },
        {
            "id": "US-034",
            "title": "Unit tests for SecuritySummary value object",
            "description": "Add unit tests for SecuritySummary creation and equality",
            "acceptanceCriteria": [
                "Tests verify SecuritySummary can be created with valid properties",
                "Tests verify record equality semantics",
                "Tests use xUnit [Fact] attributes",
                "Tests use FluentAssertions",
                "Test naming follows MethodName_Scenario_ExpectedResult pattern",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 61,
            "passes": false,
            "notes": "Domain layer unit tests",
            "dependencies": [
                "US-001"
            ]
        },
        {
            "id": "US-035",
            "title": "Unit tests for SemanticSummary value object",
            "description": "Add unit tests for SemanticSummary creation and equality",
            "acceptanceCriteria": [
                "Tests verify SemanticSummary can be created with valid properties",
                "Tests verify record equality semantics",
                "Tests use xUnit [Fact] attributes",
                "Tests use FluentAssertions",
                "Test naming follows MethodName_Scenario_ExpectedResult pattern",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 62,
            "passes": false,
            "notes": "Domain layer unit tests",
            "dependencies": [
                "US-002"
            ]
        },
        {
            "id": "US-036",
            "title": "Unit tests for Component.UpdateSummaries method",
            "description": "Add unit tests for Component domain method that updates summaries",
            "acceptanceCriteria": [
                "Tests verify UpdateSummaries sets SecuritySummary correctly",
                "Tests verify UpdateSummaries sets SemanticSummary correctly",
                "Tests verify RowVersion is incremented after update",
                "Tests use xUnit [Fact] attributes",
                "Tests use FluentAssertions",
                "Test naming follows MethodName_Scenario_ExpectedResult pattern",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 63,
            "passes": false,
            "notes": "Domain entity method unit tests",
            "dependencies": [
                "US-019"
            ]
        },
        {
            "id": "US-037",
            "title": "Unit tests for ComponentService.UpdateSummariesAsync",
            "description": "Add unit tests for UpdateSummariesAsync service method with mocked dependencies",
            "acceptanceCriteria": [
                "Tests verify successful summary update flow",
                "Tests verify ConcurrencyConflictException thrown on rowVersion mismatch",
                "Tests verify repository GetByIdForUpdateAsync is called",
                "Tests verify IUnitOfWork.SaveChangesAsync is called",
                "Tests use NSubstitute for mocking",
                "Tests use FluentAssertions",
                "Test naming follows MethodName_Scenario_ExpectedResult pattern",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 64,
            "passes": false,
            "notes": "Application layer service unit tests",
            "dependencies": [
                "US-018"
            ]
        },
        {
            "id": "US-038",
            "title": "Unit tests for SnapshotService versioning from canonical Component",
            "description": "Add unit tests verifying ComponentVersion.State is created from canonical Component",
            "acceptanceCriteria": [
                "Tests verify version State contains canonical Component identity fields",
                "Tests verify version State contains aggregated summaries",
                "Tests verify Component.CurrentVersionId is updated",
                "Tests cover Added and Modified change types",
                "Tests verify Removed change type uses minimal state",
                "Tests use NSubstitute for mocking",
                "Tests use FluentAssertions",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 65,
            "passes": false,
            "notes": "Critical tests for versioning semantics change",
            "dependencies": [
                "US-031",
                "US-033"
            ]
        },
        {
            "id": "US-039",
            "title": "Integration test for GetDiscoveriesForComponent endpoint",
            "description": "Add integration test for the discoveries endpoint returning all active discoveries for a component",
            "acceptanceCriteria": [
                "Test verifies endpoint returns discoveries from multiple repositories",
                "Test verifies response includes per-repo Security and Semantic",
                "Test verifies 404 returned for non-existent component",
                "Test uses Aspire.Hosting.Testing",
                "Test naming follows MethodName_Scenario_ExpectedResult pattern",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 66,
            "passes": false,
            "notes": "API integration test for MCP tool backing endpoint",
            "dependencies": [
                "US-020"
            ]
        },
        {
            "id": "US-040",
            "title": "Integration test for UpdateComponentSummaries endpoint",
            "description": "Add integration test for the summaries update endpoint with concurrency handling",
            "acceptanceCriteria": [
                "Test verifies successful summary update returns updated ComponentDto",
                "Test verifies stale rowVersion returns 409 Conflict",
                "Test verifies summaries are persisted correctly",
                "Test uses Aspire.Hosting.Testing",
                "Test naming follows MethodName_Scenario_ExpectedResult pattern",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 67,
            "passes": false,
            "notes": "API integration test for Aggregation Summary Agent endpoint",
            "dependencies": [
                "US-022"
            ]
        },
        {
            "id": "US-041",
            "title": "Add UpdateComponent MCP tool to Aggregation Summary Agent toolset",
            "description": "Ensure Aggregation Summary Agent has access to UpdateComponent tool for persisting summaries",
            "acceptanceCriteria": [
                "UpdateComponent tool is included in aggregation_summary agent toolset",
                "Tool allows updating SecuritySummary and SemanticSummary fields",
                "Tool requires rowVersion parameter for optimistic locking",
                "Tool is properly configured in tools factory",
                "All existing tests pass",
                "Build succeeds with no warnings",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 68,
            "passes": false,
            "notes": "Toolset configuration for Aggregation Summary Agent",
            "dependencies": [
                "US-025"
            ]
        },
        {
            "id": "US-042",
            "title": "Update search indexing to include summaries",
            "description": "Update ComponentSearchMapper to incorporate SecuritySummary and SemanticSummary in search text for improved search results",
            "acceptanceCriteria": [
                "ComponentSearchMapper includes summary fields in indexed text where beneficial",
                "SecuritySummary concerns contribute to searchable content",
                "SemanticSummary description and domains contribute to searchable content",
                "No breaking changes to existing search functionality",
                "All existing tests pass (dotnet test)",
                "Build succeeds with no warnings (dotnet build --warnaserror)",
                "No new compiler warnings introduced",
                "No TODO or FIXME comments left in code"
            ],
            "priority": 81,
            "passes": false,
            "notes": "Search enhancement per PRD Section 22 rollout step 5",
            "dependencies": [
                "US-014"
            ]
        }
    ]
}
