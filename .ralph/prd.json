{
  "projectName": "Spec Review Feature",
  "branchName": "ralph/feature",
  "language": "nodejs",
  "standardsFile": ".ralph/standards/nodejs.md",
  "description": "A comprehensive spec review feature that validates PRDs against quality standards, detects 'god specs' that should be split, and provides interactive review through CLI and dashboard interfaces",
  "userStories": [
    {
      "id": "US-001",
      "title": "Define core spec review types",
      "description": "Create TypeScript type definitions for the spec review feature including SpecReviewResult, SpecReviewCategory, FocusedPromptResult, GodSpecIndicators, SplitProposal, CodebaseContext, SuggestionCard, and ChangeHistoryEntry. These types form the foundation for all spec review functionality and ensure type safety across the codebase.",
      "acceptanceCriteria": [
        "All types defined in src/types/index.ts or dedicated type file",
        "Types match the data contracts specified in the PRD",
        "Types are exported and importable from the types module",
        "Build succeeds with no warnings",
        "No placeholder implementations"
      ],
      "testCases": [],
      "priority": 1,
      "passes": true,
      "notes": "Type definitions only - no logic to test. Types already existed from prior implementation.",
      "dependencies": [],
      "complexity": "low",
      "context": {
        "suggestions": {
          "patterns": "Use discriminated unions for verdict types (PASS | FAIL | NEEDS_IMPROVEMENT | SPLIT_RECOMMENDED)"
        }
      }
    },
    {
      "id": "US-002",
      "title": "Define session file types",
      "description": "Create TypeScript type definitions for file-based session management including SessionFile, SplitSpecRef, SuggestionCard status tracking, ChangeHistoryEntry, and ChatMessage interfaces. These types enable persistent session state stored in .ralph/sessions/.",
      "acceptanceCriteria": [
        "SessionFile interface matches PRD contract",
        "SplitSpecRef, ChangeHistoryEntry, ChatMessage interfaces defined",
        "SuggestionCard includes status field with correct enum values",
        "Types exported from session types module",
        "Build succeeds with no warnings"
      ],
      "testCases": [],
      "priority": 2,
      "passes": true,
      "notes": "Type definitions only - no logic to test. Types already existed from prior implementation (US-001/US-013).",
      "dependencies": [
        "US-001"
      ],
      "complexity": "low",
      "context": {}
    },
    {
      "id": "US-003",
      "title": "Implement session file read/write operations",
      "description": "Create the session-file.ts module that handles loading and saving session files to .ralph/sessions/{basename}.session.json. This enables persistent review state across browser sessions and allows sessions to be committed to git.",
      "acceptanceCriteria": [
        "loadSession(specFile) returns SessionFile or null if not exists",
        "saveSession(session) writes JSON to correct path",
        "getSessionPath(specFile) returns .ralph/sessions/{basename}.session.json",
        "computeContentHash(content) returns SHA256 hash",
        "Creates .ralph/sessions/ directory if not exists",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "getSessionPath_WithNestedSpecFile_ReturnsCorrectSessionPath",
        "loadSession_WithExistingSession_ReturnsSessionFile",
        "loadSession_WithNoSession_ReturnsNull",
        "saveSession_WithValidSession_WritesJsonFile",
        "saveSession_WithMissingDirectory_CreatesDirectory",
        "computeContentHash_WithContent_ReturnsSha256Hash",
        "computeContentHash_WithSameContent_ReturnsSameHash"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Implemented session-file.ts with all 4 functions. All 7 tests pass.",
      "dependencies": [
        "US-002"
      ],
      "complexity": "medium",
      "context": {
        "suggestions": {
          "patterns": "Use crypto.createHash('sha256') for content hashing"
        }
      }
    },
    {
      "id": "US-004",
      "title": "Update settings to change default CLI to Claude",
      "description": "Modify the settings module to change the default CLI from 'codex' to 'claude'. This reflects that Claude is more widely available and provides better general capability for spec review tasks.",
      "acceptanceCriteria": [
        "Default CLI in settings is 'claude'",
        "Existing config with explicit 'codex' setting still works",
        "Build succeeds with no warnings",
        "All tests pass"
      ],
      "testCases": [
        "getDefaultCli_WithNoConfig_ReturnsClaude",
        "getDefaultCli_WithExplicitCodexConfig_ReturnsCodex",
        "getDefaultCli_WithExplicitClaudeConfig_ReturnsClaude"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Implementation already existed from commit a90c27b. Tests verify default is claude and explicit codex/claude configs work.",
      "dependencies": [],
      "complexity": "low",
      "context": {}
    },
    {
      "id": "US-005",
      "title": "Implement configurable timeout for review operations",
      "description": "Create timeout configuration logic that respects priority order: CLI flag > RALPH_REVIEW_TIMEOUT_MS env var > default (10 min). Includes validation to enforce 30s minimum and 30min maximum bounds.",
      "acceptanceCriteria": [
        "getReviewTimeout() returns timeout in milliseconds",
        "CLI flag takes highest priority",
        "Environment variable RALPH_REVIEW_TIMEOUT_MS respected",
        "Default is 600000ms (10 minutes)",
        "Validates timeout is between 30s and 30min",
        "Logs warning when timeout adjusted to bounds",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "getReviewTimeout_WithCliFlag_ReturnsCliValue",
        "getReviewTimeout_WithEnvVar_ReturnsEnvValue",
        "getReviewTimeout_WithNoConfig_ReturnsDefault",
        "getReviewTimeout_WithCliFlagAndEnvVar_PrefersCliFlag",
        "validateTimeout_BelowMinimum_ReturnsMinimum",
        "validateTimeout_AboveMaximum_ReturnsMaximum",
        "validateTimeout_WithinBounds_ReturnsValue"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Implementation existed in timeout.ts. Added comprehensive test suite with all 7 required test cases.",
      "dependencies": [],
      "complexity": "low",
      "context": {}
    },
    {
      "id": "US-006",
      "title": "Create focused prompt definitions for standalone spec review",
      "description": "Define the 5 focused prompts for standalone spec review: god spec detection, requirements completeness, clarity/specificity, testability, and scope validation. Each prompt has a single responsibility and returns structured JSON output.",
      "acceptanceCriteria": [
        "GOD_SPEC_DETECTION_PROMPT defined with indicators list",
        "REQUIREMENTS_COMPLETENESS_PROMPT defined",
        "CLARITY_SPECIFICITY_PROMPT defined",
        "TESTABILITY_PROMPT defined",
        "SCOPE_VALIDATION_PROMPT defined",
        "Each prompt includes input/output format specification",
        "Each prompt returns structured JSON with verdict field",
        "Build succeeds with no warnings"
      ],
      "testCases": [],
      "priority": 6,
      "passes": true,
      "notes": "Prompt templates only - tested via integration. All 5 prompts already existed in src/core/spec-review/prompts.ts with proper structure.",
      "dependencies": [
        "US-001"
      ],
      "complexity": "low",
      "context": {
        "suggestions": {
          "examples": "See PRD Technical Notes section for prompt structure examples"
        }
      }
    },
    {
      "id": "US-007",
      "title": "Create focused prompt definitions for decompose review",
      "description": "Define the 4 focused prompts for decompose review (task validation): missing requirements, contradictions, dependency validation, and duplicate detection. These prompts run without tools for pure document comparison.",
      "acceptanceCriteria": [
        "MISSING_REQUIREMENTS_PROMPT defined",
        "CONTRADICTIONS_PROMPT defined",
        "DEPENDENCY_VALIDATION_PROMPT defined",
        "DUPLICATE_DETECTION_PROMPT defined",
        "Each prompt includes spec and tasks JSON placeholders",
        "Each prompt returns structured JSON with verdict field",
        "Build succeeds with no warnings"
      ],
      "testCases": [],
      "priority": 7,
      "passes": true,
      "notes": "Prompt templates only - tested via integration. All 4 decompose review prompts already existed in src/core/spec-review/prompts.ts with proper structure: buildDecomposeContextHeader() providing {specContent} and {tasksJson} placeholders, buildDecomposeOutputFormat() providing verdict field with PASS/FAIL values.",
      "dependencies": [
        "US-001"
      ],
      "complexity": "low",
      "context": {}
    },
    {
      "id": "US-008",
      "title": "Implement codebase context gathering",
      "description": "Create the codebase-context.ts module that explores the project structure, identifies technology stack from config files, and finds relevant patterns. This context is used by the spec review agent to validate specs against actual architecture.",
      "acceptanceCriteria": [
        "gatherCodebaseContext() returns CodebaseContext object",
        "Identifies project type from package.json, tsconfig, etc.",
        "Lists existing patterns found in codebase",
        "Identifies relevant directories for the spec being reviewed",
        "Context is serializable for inclusion in prompts",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "gatherCodebaseContext_WithPackageJson_IdentifiesNodeProject",
        "gatherCodebaseContext_WithTsConfig_IdentifiesTypeScript",
        "gatherCodebaseContext_WithSrcDirectory_ListsPatterns",
        "gatherCodebaseContext_ReturnsSerializableObject"
      ],
      "priority": 8,
      "passes": true,
      "notes": "Added tsconfig.json detection for TypeScript identification. All 4 required tests pass plus 6 bonus tests (10 total).",
      "dependencies": [
        "US-001"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-009",
      "title": "Implement god spec detection logic",
      "description": "Create the god-spec-detector.ts module that analyzes specs for god spec indicators: size (>3 sections, >15 stories, >2000 words), scope (multiple journeys, >3 boundaries), and cohesion (no single done definition). Returns detection result with split recommendation.",
      "acceptanceCriteria": [
        "detectGodSpec(specContent, codebaseContext) returns detection result",
        "Checks all size indicators from PRD",
        "Checks all scope indicators from PRD",
        "Checks all cohesion indicators from PRD",
        "Returns isGodSpec: true if 2+ indicators present",
        "Estimates story count for the spec",
        "Identifies feature domains and system boundaries",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "detectGodSpec_WithSmallSpec_ReturnsNotGodSpec",
        "detectGodSpec_WithManyFeatureSections_ReturnsGodSpec",
        "detectGodSpec_WithHighEstimatedStories_ReturnsGodSpec",
        "detectGodSpec_WithMultipleUserJourneys_ReturnsGodSpec",
        "detectGodSpec_WithOneIndicator_ReturnsNotGodSpec",
        "detectGodSpec_WithTwoIndicators_ReturnsGodSpec",
        "estimateStoryCount_WithTypicalSpec_ReturnsReasonableEstimate"
      ],
      "priority": 9,
      "passes": true,
      "notes": "Implemented god-spec-detector.ts with size, scope, and cohesion indicator checks. All 7 tests pass.",
      "dependencies": [
        "US-001",
        "US-008"
      ],
      "complexity": "high",
      "context": {}
    },
    {
      "id": "US-010",
      "title": "Implement split proposal generation",
      "description": "Extend the god spec detector to generate split proposals when a god spec is detected. Proposals include logical feature boundaries, file names following the {basename}.{feature}.md convention, and estimated story counts per split.",
      "acceptanceCriteria": [
        "generateSplitProposal(specContent, indicators) returns SplitProposal",
        "Identifies logical feature boundaries in spec",
        "Generates filenames with {basename}.{feature}.md pattern",
        "Feature names are kebab-case, 1-3 words",
        "Each proposed spec has description and estimated stories",
        "Each proposed spec references original sections",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "generateSplitProposal_WithUserManagementSpec_ReturnsValidProposal",
        "generateSplitProposal_GeneratesKebabCaseFilenames",
        "generateSplitProposal_EachProposalHasEstimatedStories",
        "generateSplitProposal_EachProposalReferencesSections",
        "generateFilename_WithBasenameAndFeature_ReturnsCorrectPattern"
      ],
      "priority": 10,
      "passes": true,
      "notes": "Implemented generateSplitProposal and generateFilename functions. All 12 tests pass (including 5 new tests for this feature).",
      "dependencies": [
        "US-009"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-011",
      "title": "Implement spec splitter execution",
      "description": "Create the splitter.ts module that executes spec splitting by creating new spec files from a split proposal. Creates files in the same directory as the original, preserves original spec, and adds 'Split from' header to each new file.",
      "acceptanceCriteria": [
        "executeSplit(originalPath, proposal) creates new spec files",
        "New files placed in same directory as original",
        "Original spec is NOT deleted or modified",
        "Each new file includes 'Split from: {original}' header",
        "Each new file contains relevant sections from original",
        "Returns list of created file paths",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "executeSplit_WithValidProposal_CreatesAllFiles",
        "executeSplit_PreservesOriginalSpec",
        "executeSplit_AddsSplitFromHeader",
        "executeSplit_PlacesFilesInSameDirectory",
        "executeSplit_ReturnsCreatedFilePaths"
      ],
      "priority": 11,
      "passes": true,
      "notes": "Implemented splitter.ts with executeSplit function. Creates new spec files from split proposals, preserves original, adds 'Split from' header. All 5 tests pass.",
      "dependencies": [
        "US-010"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-012",
      "title": "Implement result aggregator for spec review",
      "description": "Create the aggregator.ts module that combines results from all focused prompts into a single SpecReviewResult with overall verdict. SPLIT_RECOMMENDED takes highest priority, then FAIL, then NEEDS_IMPROVEMENT, then PASS.",
      "acceptanceCriteria": [
        "aggregateResults(promptResults) returns SpecReviewResult",
        "Computes overall verdict with correct priority",
        "SPLIT_RECOMMENDED > FAIL > NEEDS_IMPROVEMENT > PASS",
        "Combines all issues into categorized output",
        "Prioritizes suggestions by severity",
        "Includes split proposal if verdict is SPLIT_RECOMMENDED",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "aggregateResults_AllPass_ReturnsPass",
        "aggregateResults_OneNeedsImprovement_ReturnsNeedsImprovement",
        "aggregateResults_OneFail_ReturnsFail",
        "aggregateResults_SplitRecommended_ReturnsSplitRecommended",
        "aggregateResults_FailAndSplitRecommended_ReturnsSplitRecommended",
        "aggregateResults_CombinesIssuesFromAllPrompts",
        "aggregateResults_SortsSuggestionsBySeverity"
      ],
      "priority": 12,
      "passes": true,
      "notes": "",
      "dependencies": [
        "US-001"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-013",
      "title": "Implement spec review runner for standalone review",
      "description": "Create the runner.ts module that orchestrates the spec review process: loads golden standards, spawns CLI agent WITH tools enabled, runs focused prompts sequentially (god spec first), and returns aggregated results.",
      "acceptanceCriteria": [
        "runSpecReview(specPath, options) orchestrates full review",
        "Loads golden standard from .ralph/standards/",
        "Spawns Claude/Codex WITH full tool access (NOT --tools '')",
        "Runs god spec detection prompt first",
        "Runs remaining 4 prompts sequentially",
        "Aggregates results using aggregator module",
        "Respects configured timeout",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "runSpecReview_WithValidSpec_ReturnsResult",
        "runSpecReview_LoadsGoldenStandard",
        "runSpecReview_SpawnsAgentWithTools",
        "runSpecReview_RunsGodSpecFirst",
        "runSpecReview_RespectsTimeout",
        "runSpecReview_AggregatesPromptResults"
      ],
      "priority": 13,
      "passes": true,
      "notes": "Implemented runSpecReview function with sequential prompt execution, golden standard loading, and result aggregation. All 6 tests pass.",
      "dependencies": [
        "US-005",
        "US-006",
        "US-008",
        "US-009",
        "US-012"
      ],
      "complexity": "high",
      "context": {}
    },
    {
      "id": "US-014",
      "title": "Implement spec review runner for decompose review",
      "description": "Create or extend the runner to handle decompose review (task validation). This mode runs focused prompts WITHOUT tools for pure document comparison between spec and generated tasks.",
      "acceptanceCriteria": [
        "runDecomposeReview(specContent, tasksJson) validates tasks",
        "Spawns agent WITHOUT tools (uses --tools '')",
        "Runs 4 decompose-specific focused prompts",
        "Returns aggregated PASS/FAIL verdict",
        "Includes missing requirements, contradictions, dependency errors, duplicates",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "runDecomposeReview_WithValidTasks_ReturnsResult",
        "runDecomposeReview_SpawnsAgentWithoutTools",
        "runDecomposeReview_ChecksMissingRequirements",
        "runDecomposeReview_ChecksContradictions",
        "runDecomposeReview_ChecksDependencies",
        "runDecomposeReview_ChecksDuplicates"
      ],
      "priority": 14,
      "passes": true,
      "notes": "Implemented runDecomposeReview function that validates tasks against specs. Uses --tools '' to disable tools, runs 4 decompose prompts, returns aggregated ReviewFeedback. All 6 tests pass.",
      "dependencies": [
        "US-005",
        "US-007",
        "US-012"
      ],
      "complexity": "high",
      "context": {}
    },
    {
      "id": "US-015",
      "title": "Create spec parent CLI command",
      "description": "Create the spec.ts parent command that registers subcommands for spec-related operations. Initially just registers the 'review' subcommand.",
      "acceptanceCriteria": [
        "qala spec --help shows available subcommands",
        "spec command registered in main CLI index",
        "review subcommand properly delegated",
        "Build succeeds with no warnings"
      ],
      "testCases": [],
      "priority": 15,
      "passes": true,
      "notes": "CLI wiring only - tested via integration",
      "dependencies": [],
      "complexity": "low",
      "context": {}
    },
    {
      "id": "US-016",
      "title": "Implement spec review CLI command with file argument",
      "description": "Create the spec-review.ts command that handles qala spec review <file>. Validates the file exists and is markdown, then delegates to the review runner.",
      "acceptanceCriteria": [
        "qala spec review <file> runs review on specified file",
        "Validates file exists before proceeding",
        "Validates file has .md extension",
        "Displays error for missing/invalid file",
        "Delegates to review runner",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "specReview_WithValidFile_DelegatesToRunner",
        "specReview_WithMissingFile_DisplaysError",
        "specReview_WithNonMarkdownFile_DisplaysError"
      ],
      "priority": 16,
      "passes": true,
      "notes": "Added validateSpecFile function with file existence and .md extension checks. All 3 tests pass.",
      "dependencies": [
        "US-013",
        "US-015"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-017",
      "title": "Implement interactive file picker for spec review",
      "description": "Extend the spec review CLI to show an interactive file picker when no file argument is provided. Searches for markdown files in specs/, docs/, .ralph/specs/, and current directory.",
      "acceptanceCriteria": [
        "qala spec review (no args) shows file picker",
        "Searches specs/, docs/, .ralph/specs/, current directory",
        "Displays found markdown files in interactive list",
        "User can select file to proceed with review",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "specReview_WithNoArgs_ShowsFilePicker",
        "findSpecFiles_SearchesAllDirectories",
        "findSpecFiles_ReturnsOnlyMarkdownFiles"
      ],
      "priority": 17,
      "passes": true,
      "notes": "Added @inquirer/prompts dependency, implemented findSpecFiles function and interactive file picker using select(). All 3 required tests pass (6 total in spec.test.ts).",
      "dependencies": [
        "US-016"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-018",
      "title": "Implement CLI options for timeout and cli selection",
      "description": "Add --timeout, --cli, --verbose, and --json options to the spec review command. These allow users to override default timeout, select Claude/Codex, enable verbose output, and get JSON output.",
      "acceptanceCriteria": [
        "--timeout <ms> overrides default timeout",
        "--cli claude|codex overrides config setting",
        "--verbose shows detailed progress output",
        "--json outputs machine-readable JSON",
        "-h/--help displays all options",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "specReview_WithTimeoutFlag_UsesProvidedTimeout",
        "specReview_WithCliFlag_UsesProvidedCli",
        "specReview_WithVerboseFlag_ShowsDetailedOutput",
        "specReview_WithJsonFlag_OutputsJson"
      ],
      "priority": 18,
      "passes": true,
      "notes": "Added --timeout, --cli, --verbose, --json options to spec review command. Extended SpecReviewOptions with cli and onProgress callback. All 4 required tests pass (10 total in spec.test.ts).",
      "dependencies": [
        "US-016"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-019",
      "title": "Implement human-readable CLI output formatting",
      "description": "Create output formatting for the default (non-JSON) CLI output. Displays verdict, per-category results, suggestions, and log path in a readable format matching the PRD data contract.",
      "acceptanceCriteria": [
        "Displays header with spec filename",
        "Shows overall verdict prominently",
        "Lists each category with its verdict and issues",
        "Shows suggestions prioritized by severity",
        "Displays log file path",
        "Format matches PRD data contract",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "formatOutput_WithPassVerdict_DisplaysPass",
        "formatOutput_WithNeedsImprovement_ShowsIssues",
        "formatOutput_WithSplitRecommended_ShowsProposal",
        "formatOutput_ShowsSuggestionsInPriorityOrder"
      ],
      "priority": 19,
      "passes": true,
      "notes": "Implemented enhanced formatHumanOutput with header, per-category verdicts, split proposal display, and severity-sorted suggestions. All 4 tests pass.",
      "dependencies": [
        "US-016"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-020",
      "title": "Implement god spec CLI user interaction",
      "description": "When a god spec is detected, display the split recommendation and prompt user with Accept/Modify/Skip options. Handle each option appropriately: Accept creates files, Modify allows editing, Skip continues with warning.",
      "acceptanceCriteria": [
        "Displays god spec warning with detected issues",
        "Shows proposed split with estimated story counts",
        "Prompts user with Accept/Modify/Skip options",
        "Accept: calls splitter to create files",
        "Modify: allows user to edit proposal before creating",
        "Skip: continues review with warning",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "handleGodSpec_DisplaysWarningAndProposal",
        "handleGodSpec_AcceptCreatesFiles",
        "handleGodSpec_SkipContinuesWithWarning"
      ],
      "priority": 20,
      "passes": true,
      "notes": "Implemented handleGodSpec function with displayGodSpecWarning, promptGodSpecAction, editProposal helper functions. Accept calls executeSplit, Modify opens editor, Skip continues with warning. All 3 tests pass (17 total in spec.test.ts).",
      "dependencies": [
        "US-011",
        "US-019"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-021",
      "title": "Implement review logging",
      "description": "Create logging functionality that saves review results to .ralph/logs/. Creates human-readable log, separate prompt/response files, and JSON summary as specified in FR-9.",
      "acceptanceCriteria": [
        "Creates .ralph/logs/spec_review_<timestamp>.log",
        "Creates .ralph/logs/spec_review_<timestamp>.prompts/ directory",
        "Saves each prompt's input/output to prompts directory",
        "Creates .ralph/logs/spec_review_<timestamp>.json for machine access",
        "Logs created on both success and failure",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "saveReviewLog_CreatesLogFile",
        "saveReviewLog_CreatesPromptsDirectory",
        "saveReviewLog_CreatesJsonSummary",
        "saveReviewLog_LogsOnFailure"
      ],
      "priority": 21,
      "passes": true,
      "notes": "Implemented review-logger.ts with saveReviewLog function that creates .log file, .prompts/ directory, and .json summary. Integrated with runner.ts. All 4 tests pass.",
      "dependencies": [
        "US-013"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-022",
      "title": "Implement error handling for CLI not available",
      "description": "Add error handling when the selected CLI (claude or codex) is not installed. Displays helpful error message with installation instructions.",
      "acceptanceCriteria": [
        "Detects when CLI binary is not in PATH",
        "Displays specific error message naming the missing CLI",
        "Provides installation instructions",
        "Exits with code 1",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "runReview_WithMissingClaude_DisplaysInstallInstructions",
        "runReview_WithMissingCodex_DisplaysInstallInstructions",
        "checkCliAvailable_ReturnsTrue_WhenInstalled",
        "checkCliAvailable_ReturnsFalse_WhenMissing"
      ],
      "priority": 22,
      "passes": true,
      "notes": "",
      "dependencies": [
        "US-013"
      ],
      "complexity": "low",
      "context": {}
    },
    {
      "id": "US-023",
      "title": "Implement error handling for timeout",
      "description": "Add error handling when the review agent times out. Terminates gracefully with SIGTERM then SIGKILL, displays partial results if available, and provides guidance on increasing timeout.",
      "acceptanceCriteria": [
        "Sends SIGTERM when timeout elapses",
        "Sends SIGKILL after 5 seconds if process still running",
        "Displays timeout message with current timeout value",
        "Shows partial results if any prompts completed",
        "Suggests increasing timeout with --timeout or env var",
        "Exits with code 1",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "handleTimeout_TerminatesProcess",
        "handleTimeout_DisplaysPartialResults",
        "handleTimeout_SuggestsIncreasingTimeout"
      ],
      "priority": 23,
      "passes": true,
      "notes": "Implemented SIGTERM/SIGKILL cascade in runPrompt, TimeoutInfo tracking in runSpecReview, displayTimeoutError CLI function with timeout guidance. All 3 required tests pass.",
      "dependencies": [
        "US-013"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-024",
      "title": "Integrate --review flag with decompose command",
      "description": "Modify the decompose command to accept a --review flag that triggers automatic peer review after decomposition completes. Uses the decompose-specific focused prompts.",
      "acceptanceCriteria": [
        "qala decompose <file> --review triggers review after decompose",
        "Uses decompose review runner (without tools)",
        "On FAIL, attempts automatic revision up to MAX_REVIEW_ATTEMPTS",
        "Respects same timeout and CLI settings as standalone review",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "decompose_WithReviewFlag_TriggersReview",
        "decompose_WithReviewFail_RetriesRevision",
        "decompose_WithReviewFlag_UsesConfiguredTimeout"
      ],
      "priority": 24,
      "passes": true,
      "notes": "Integrated runDecomposeReview with decompose workflow. Added --timeout flag. All 3 tests pass.",
      "dependencies": [
        "US-014"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-025",
      "title": "Implement exit codes for spec review CLI",
      "description": "Ensure the spec review command exits with appropriate codes: 0 for PASS, 1 for FAIL/NEEDS_IMPROVEMENT/SPLIT_RECOMMENDED, 2 for errors.",
      "acceptanceCriteria": [
        "Exit code 0 on PASS verdict",
        "Exit code 1 on FAIL verdict",
        "Exit code 1 on NEEDS_IMPROVEMENT verdict",
        "Exit code 1 on SPLIT_RECOMMENDED verdict",
        "Exit code 2 on error (file not found, CLI missing, etc.)",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "specReview_PassVerdict_ExitsZero",
        "specReview_FailVerdict_ExitsOne",
        "specReview_NeedsImprovement_ExitsOne",
        "specReview_SplitRecommended_ExitsOne",
        "specReview_Error_ExitsTwo"
      ],
      "priority": 25,
      "passes": true,
      "notes": "Added getExitCodeForVerdict() utility function. Changed error exits from 1 to 2. All 5 tests pass.",
      "dependencies": [
        "US-016"
      ],
      "complexity": "low",
      "context": {}
    },
    {
      "id": "US-026",
      "title": "Implement dynamic loop limit calculation",
      "description": "Create the loop-limit.ts module that calculates execution loop limits dynamically based on task count. Formula: ceil((existingTasks + newTasks) * 1.2). This replaces the hardcoded 25 limit.",
      "acceptanceCriteria": [
        "calculateLoopLimit(existing, new) returns correct limit",
        "Uses formula: ceil((existing + new) * 1.2)",
        "Rounds up to nearest integer",
        "Handles zero tasks case",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "calculateLoopLimit_With10Tasks_Returns12",
        "calculateLoopLimit_With20Existing5New_Returns30",
        "calculateLoopLimit_With0Tasks_Returns0",
        "calculateLoopLimit_RoundsUp"
      ],
      "priority": 26,
      "passes": true,
      "notes": "Fixed zero-task case to return 0 (formula: 0 * 1.2 = 0). All 4 tests pass.",
      "dependencies": [],
      "complexity": "low",
      "context": {}
    },
    {
      "id": "US-027",
      "title": "Integrate dynamic loop limit with task executor",
      "description": "Modify the task executor to use the dynamic loop limit instead of hardcoded 25. Recalculates limit when new tasks are added during execution.",
      "acceptanceCriteria": [
        "Task executor uses calculateLoopLimit() instead of hardcoded 25",
        "Limit recalculated when tasks added mid-execution",
        "All existing tasks fit within calculated window",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "taskExecutor_UsesDynamicLimit",
        "taskExecutor_RecalculatesOnTaskAddition",
        "taskExecutor_AllTasksFitInWindow"
      ],
      "priority": 27,
      "passes": true,
      "notes": "Modified start.ts CLI to use getter function, added onTasksChanged callback to LoopOptions, implemented recalculation when PRD reloaded with more tasks. All 3 tests pass.",
      "dependencies": [
        "US-026"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-028",
      "title": "Create spec review API routes",
      "description": "Create the server routes for spec review in src/server/routes/spec-review.ts. Includes endpoints for listing files, starting review, getting status, and executing splits.",
      "acceptanceCriteria": [
        "GET /api/spec-review/files lists available spec files",
        "POST /api/spec-review/start initiates review session",
        "GET /api/spec-review/status/:sessionId returns review status/results",
        "POST /api/spec-review/split executes spec split",
        "POST /api/spec-review/split/preview previews split files",
        "All routes properly authenticated",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "GET_files_ReturnsMarkdownFiles",
        "POST_start_InitiatesReview",
        "GET_status_ReturnsResults",
        "POST_split_CreatesFiles",
        "POST_splitPreview_ReturnsPreview"
      ],
      "priority": 28,
      "passes": true,
      "notes": "",
      "dependencies": [
        "US-013",
        "US-011"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-029",
      "title": "Create session API routes",
      "description": "Create API routes for session management in src/server/routes/sessions.ts. Handles loading, saving, and checking existence of session files.",
      "acceptanceCriteria": [
        "GET /api/sessions/spec/:specPath loads session",
        "PUT /api/sessions/spec/:specPath saves session state",
        "GET /api/sessions/spec/:specPath/exists checks existence",
        "All routes properly authenticated",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "GET_session_WithExisting_ReturnsSession",
        "GET_session_WithMissing_ReturnsNull",
        "PUT_session_SavesState",
        "GET_exists_ReturnsTrueWhenExists"
      ],
      "priority": 29,
      "passes": true,
      "notes": "",
      "dependencies": [
        "US-003"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-030",
      "title": "Create feedback and chat API routes",
      "description": "Add API routes for handling user feedback (approve/reject/edit) and chat messages. These routes enable the interactive dashboard experience.",
      "acceptanceCriteria": [
        "POST /api/spec-review/feedback handles approve/reject/edit",
        "POST /api/spec-review/chat sends chat messages to agent",
        "POST /api/spec-review/revert reverts a change",
        "GET /api/spec-review/suggestions/:sessionId gets pending suggestions",
        "All routes properly authenticated",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "POST_feedback_Approved_UpdatesSession",
        "POST_feedback_Rejected_UpdatesSession",
        "POST_feedback_Edited_UpdatesSession",
        "POST_chat_SendsToAgent",
        "POST_revert_RestoresPreviousContent"
      ],
      "priority": 30,
      "passes": true,
      "notes": "",
      "dependencies": [
        "US-029"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-031",
      "title": "Implement change tracker for revert functionality",
      "description": "Create the change-tracker.ts module that tracks all changes made during a review session and enables reverting individual changes.",
      "acceptanceCriteria": [
        "trackChange(entry) adds to change history",
        "revertChange(changeId) restores previous content",
        "revertAll() restores original spec content",
        "Changes are persisted to session file",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "trackChange_AddsToHistory",
        "revertChange_RestoresContent",
        "revertAll_RestoresOriginal",
        "trackChange_PersistsToSession"
      ],
      "priority": 31,
      "passes": true,
      "notes": "",
      "dependencies": [
        "US-003"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-032",
      "title": "Implement feedback handler for agent context",
      "description": "Create the feedback-handler.ts module that processes user feedback (approve/reject/edit), updates the agent context for preference learning, and triggers alternative proposals after rejections.",
      "acceptanceCriteria": [
        "handleApproval(feedback) updates agent context",
        "handleRejection(feedback) updates context and may trigger alternative",
        "handleEdit(feedback) learns from user modifications",
        "Agent context maintained within session",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "handleApproval_UpdatesAgentContext",
        "handleRejection_UpdatesContext",
        "handleRejection_CanTriggerAlternative",
        "handleEdit_LearnsFromModification"
      ],
      "priority": 32,
      "passes": true,
      "notes": "Implemented feedback-handler.ts with AgentContext tracking, handleApproval, handleRejection, handleEdit functions. All 8 tests pass (including edge cases).",
      "dependencies": [
        "US-003"
      ],
      "complexity": "high",
      "context": {}
    },
    {
      "id": "US-033",
      "title": "Create SpecReviewPage dashboard component",
      "description": "Create the main SpecReviewPage.tsx component that serves as the container for the spec review feature in the dashboard. Implements the split view layout with spec editor (left) and review panel (right).",
      "acceptanceCriteria": [
        "Page renders with split view layout",
        "Left panel contains spec editor placeholder",
        "Right panel contains review panel placeholder",
        "Panels are resizable",
        "File selection dropdown available",
        "Page accessible from dashboard sidebar",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "SpecReviewPage_RendersSplitLayout",
        "SpecReviewPage_PanelsAreResizable",
        "SpecReviewPage_ShowsFileSelector"
      ],
      "priority": 33,
      "passes": true,
      "notes": "",
      "dependencies": [],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-034",
      "title": "Create MDXEditor configuration",
      "description": "Create the MDXEditor plugin configuration in web/src/lib/mdx-editor/config.ts. Configures all required plugins: headings, lists, quotes, code blocks, tables, markdown shortcuts, and diff source.",
      "acceptanceCriteria": [
        "Configuration exports plugin array for MDXEditor",
        "headingsPlugin configured",
        "listsPlugin configured",
        "quotePlugin configured",
        "codeBlockPlugin configured with syntax highlighting",
        "tablePlugin configured",
        "markdownShortcutPlugin configured",
        "diffSourcePlugin configured for diff view mode",
        "Build succeeds with no warnings"
      ],
      "testCases": [],
      "priority": 34,
      "passes": true,
      "notes": "Configuration only - tested via integration",
      "dependencies": [],
      "complexity": "low",
      "context": {}
    },
    {
      "id": "US-035",
      "title": "Create SpecEditor component with MDXEditor",
      "description": "Create the SpecEditor.tsx component that wraps MDXEditor for the left panel. Handles spec content display, editing, and provides ref for programmatic control.",
      "acceptanceCriteria": [
        "Component renders MDXEditor with configured plugins",
        "Displays spec content in WYSIWYG mode",
        "Editor ref exposed for programmatic access",
        "onChange handler syncs content to application state",
        "Supports both WYSIWYG and source view modes",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "SpecEditor_RendersMDXEditor",
        "SpecEditor_DisplaysContent",
        "SpecEditor_ExposesRef",
        "SpecEditor_SyncsOnChange"
      ],
      "priority": 35,
      "passes": true,
      "notes": "",
      "dependencies": [
        "US-034"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-036",
      "title": "Implement Lexical utilities for scroll and highlight",
      "description": "Create the lexical-utils.ts module with utilities for scrolling to sections, highlighting text, and finding nodes by text content. These enable the 'Show in Editor' functionality.",
      "acceptanceCriteria": [
        "scrollToSection(editor, sectionHeading) scrolls to heading",
        "scrollToLine(editor, lineNumber) scrolls to line",
        "highlightText(editor, textSnippet, duration) applies temporary highlight",
        "findNodeByText(editor, text) finds Lexical node containing text",
        "getSelectedText(editor) returns current selection",
        "Highlight fades after specified duration",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "scrollToSection_ScrollsToHeading",
        "highlightText_AppliesHighlight",
        "highlightText_FadesAfterDuration",
        "findNodeByText_FindsNode",
        "getSelectedText_ReturnsSelection"
      ],
      "priority": 36,
      "passes": true,
      "notes": "Implemented lexical-utils.ts with scrollToSection, scrollToLine, highlightText, findNodeByText, getSelectedText, and selectText functions. All 19 tests pass.",
      "dependencies": [
        "US-035"
      ],
      "complexity": "high",
      "context": {}
    },
    {
      "id": "US-037",
      "title": "Implement diff view utilities",
      "description": "Create the diff-utils.ts module with utilities for entering/exiting diff mode, getting proposed content, and generating unified diffs. These enable the diff-based suggestion review.",
      "acceptanceCriteria": [
        "showDiff(editorRef, original, proposed, location) enters diff mode",
        "exitDiffView(editorRef, applyChanges) exits diff mode",
        "getProposedContent(editorRef) gets user-edited proposed content",
        "createUnifiedDiff(original, modified) generates diff string",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "showDiff_EntersDiffMode",
        "exitDiffView_ExitsDiffMode",
        "exitDiffView_AppliesChangesWhenTrue",
        "getProposedContent_ReturnsEditedContent",
        "createUnifiedDiff_GeneratesDiff"
      ],
      "priority": 37,
      "passes": true,
      "notes": "Implemented diff-utils.ts with showDiff, exitDiffView, getProposedContent, createUnifiedDiff functions. Added diff library for unified diff generation. Also added hasDifferences and countDiffChanges helper utilities. All 22 tests pass.",
      "dependencies": [
        "US-035"
      ],
      "complexity": "high",
      "context": {}
    },
    {
      "id": "US-038",
      "title": "Create ReviewPanel component",
      "description": "Create the ReviewPanel.tsx component for the right side of the split view. Contains suggestion cards, god spec warning, and chat interface areas.",
      "acceptanceCriteria": [
        "Component renders review results container",
        "Displays verdict prominently",
        "Contains area for suggestion cards",
        "Contains area for god spec warning when applicable",
        "Contains chat interface area",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "ReviewPanel_RendersContainer",
        "ReviewPanel_DisplaysVerdict",
        "ReviewPanel_ContainsSuggestionArea",
        "ReviewPanel_ContainsChatArea"
      ],
      "priority": 38,
      "passes": true,
      "notes": "Created ReviewPanel.tsx with verdict display, suggestions area, god spec warning section, and chat interface. All 21 tests pass.",
      "dependencies": [
        "US-033"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-039",
      "title": "Create SuggestionCard component",
      "description": "Create the SuggestionCard.tsx component that displays individual suggestions with issue description, severity, and action buttons: Review Diff, Show in Editor, Dismiss.",
      "acceptanceCriteria": [
        "Card displays issue description and location",
        "Shows severity indicator (critical, warning, info)",
        "Shows preview of proposed change",
        "[Review Diff] button triggers diff view",
        "[Show in Editor] button scrolls and highlights",
        "[Dismiss] button rejects suggestion",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "SuggestionCard_DisplaysIssue",
        "SuggestionCard_ShowsSeverity",
        "SuggestionCard_ReviewDiffTriggersDiff",
        "SuggestionCard_ShowInEditorScrolls",
        "SuggestionCard_DismissRejects"
      ],
      "priority": 39,
      "passes": true,
      "notes": "",
      "dependencies": [
        "US-038"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-040",
      "title": "Create GodSpecWarning component",
      "description": "Create the GodSpecWarning.tsx component that displays when a god spec is detected. Shows warning, detected issues, proposed split, and Accept/Modify/Skip buttons.",
      "acceptanceCriteria": [
        "Shows warning icon and 'God Spec Detected' header",
        "Explains why the spec is problematic",
        "Lists proposed split specs with estimated story counts",
        "[Accept Split] button creates split files",
        "[Modify] button allows editing proposal",
        "[Skip] button dismisses with warning",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "GodSpecWarning_DisplaysWarning",
        "GodSpecWarning_ShowsProposedSplit",
        "GodSpecWarning_AcceptCreatesSplits",
        "GodSpecWarning_SkipDismissesWithWarning"
      ],
      "priority": 40,
      "passes": true,
      "notes": "Component implemented with warning display, issue listing, split proposal display, and Accept/Modify/Skip buttons. 23 tests pass.",
      "dependencies": [
        "US-038"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-041",
      "title": "Create ReviewChat component",
      "description": "Create the ReviewChat.tsx component for the chat interface at the bottom of the review panel. Allows users to ask questions and request custom changes.",
      "acceptanceCriteria": [
        "Displays chat message history",
        "Shows input field for new messages",
        "Sends messages to agent via API",
        "Displays agent responses",
        "Supports selection context when user has text selected",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "ReviewChat_DisplaysHistory",
        "ReviewChat_SendsMessages",
        "ReviewChat_DisplaysResponses",
        "ReviewChat_IncludesSelectionContext"
      ],
      "priority": 41,
      "passes": true,
      "notes": "Implemented ReviewChat.tsx with chat history display, input field, message sending, assistant responses, and selection context support. All 20 tests pass.",
      "dependencies": [
        "US-038"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-042",
      "title": "Create ChangeHistory component",
      "description": "Create the ChangeHistory.tsx component that displays all applied changes with the ability to revert individual changes or all changes.",
      "acceptanceCriteria": [
        "Shows list of all applied changes",
        "Each change shows timestamp, description, section affected",
        "[Revert] button on each change to undo it",
        "[Revert All] button to restore original spec",
        "Reverting updates spec preview and re-enables suggestion",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "ChangeHistory_DisplaysChanges",
        "ChangeHistory_RevertRestoresContent",
        "ChangeHistory_RevertAllRestoresOriginal"
      ],
      "priority": 42,
      "passes": true,
      "notes": "Implemented ChangeHistory.tsx component with change list display, timestamp formatting, section extraction, Revert and Revert All buttons. 19 tests pass.",
      "dependencies": [
        "US-038"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-043",
      "title": "Create useSpecReview hook for state management",
      "description": "Create the useSpecReview.ts hook that manages the spec review session state including suggestions, verdict, and review progress.",
      "acceptanceCriteria": [
        "Hook manages review session state",
        "Provides startReview() function",
        "Tracks suggestions with their status",
        "Tracks overall verdict",
        "Provides loading and error states",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "useSpecReview_InitializesState",
        "useSpecReview_StartReviewLoads",
        "useSpecReview_TracksSuggestions",
        "useSpecReview_TracksVerdict"
      ],
      "priority": 43,
      "passes": true,
      "notes": "Implemented useSpecReview hook with state management, startReview(), suggestion tracking, verdict tracking, and loading/error states. All 19 tests pass.",
      "dependencies": [
        "US-028"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-044",
      "title": "Create useSpecEditor hook for editor state",
      "description": "Create the useSpecEditor.ts hook that manages MDXEditor state including content, selection, and editor ref for programmatic control.",
      "acceptanceCriteria": [
        "Hook provides editor ref",
        "Tracks current content state",
        "Provides selection text accessor",
        "Provides functions for scroll/highlight",
        "Provides functions for entering/exiting diff mode",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "useSpecEditor_ProvidesRef",
        "useSpecEditor_TracksContent",
        "useSpecEditor_ProvidesSelection",
        "useSpecEditor_ProvideDiffFunctions"
      ],
      "priority": 44,
      "passes": true,
      "notes": "Implemented useSpecEditor hook that wraps MDXEditor with editor ref, content tracking, selection accessor, scroll/highlight functions (using lexical-utils), and diff mode functions (using diff-utils). All 23 tests pass.",
      "dependencies": [
        "US-035",
        "US-036",
        "US-037"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-045",
      "title": "Create useSession hook for session state",
      "description": "Create the useSession.ts hook that manages loading and saving session files, detecting external changes, and providing session state to components.",
      "acceptanceCriteria": [
        "Hook loads session when spec is selected",
        "Detects external spec changes via content hash",
        "Auto-saves after every change",
        "Provides session state to components",
        "Handles Continue/Start Fresh for changed specs",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "useSession_LoadsExistingSession",
        "useSession_CreatesNewSession",
        "useSession_DetectsExternalChanges",
        "useSession_AutoSaves"
      ],
      "priority": 45,
      "passes": true,
      "notes": "Implemented useSession hook with session loading, content hash detection, auto-save, and Continue/Start Fresh dialog. All 15 tests pass.",
      "dependencies": [
        "US-029"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-046",
      "title": "Create useAgentFeedback hook",
      "description": "Create the useAgentFeedback.ts hook that handles sending approval, rejection, and edit feedback to the agent via the API.",
      "acceptanceCriteria": [
        "Hook provides sendApprovalFeedback() function",
        "Hook provides sendRejectionFeedback() function",
        "Hook provides sendEditFeedback() function",
        "Tracks feedback state (pending, sent, error)",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "useAgentFeedback_SendsApproval",
        "useAgentFeedback_SendsRejection",
        "useAgentFeedback_SendsEdit",
        "useAgentFeedback_TracksState"
      ],
      "priority": 46,
      "passes": true,
      "notes": "Implemented useAgentFeedback hook with sendApprovalFeedback, sendRejectionFeedback, sendEditFeedback functions and state tracking (idle, pending, sent, error). All 15 tests pass.",
      "dependencies": [
        "US-030"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-047",
      "title": "Implement diff view approval flow in dashboard",
      "description": "Wire up the full diff view approval flow: clicking Review Diff shows side-by-side comparison, user can approve/reject/edit, actions update spec and send feedback to agent.",
      "acceptanceCriteria": [
        "[Review Diff] switches editor to diff view mode",
        "Diff shows current vs proposed side-by-side",
        "[Approve] applies change and exits diff view",
        "[Reject] discards change and exits diff view",
        "[Edit] allows modifying proposed text before applying",
        "Changes highlight briefly (2 seconds)",
        "Feedback sent to agent after each action",
        "File saved to disk after approval/edit",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "diffApproval_ShowsSideBySide",
        "diffApproval_ApproveAppliesChange",
        "diffApproval_RejectDiscards",
        "diffApproval_EditAllowsModification",
        "diffApproval_SendsFeedback"
      ],
      "priority": 47,
      "passes": true,
      "notes": "Implemented with DiffApprovalBar component and useDiffApproval hook. All 36 tests pass.",
      "dependencies": [
        "US-039",
        "US-044",
        "US-046"
      ],
      "complexity": "high",
      "context": {}
    },
    {
      "id": "US-048",
      "title": "Implement batch suggestion navigation",
      "description": "Add navigation controls for reviewing multiple suggestions: Previous/Next buttons, Approve All/Reject All actions, and counter showing current position.",
      "acceptanceCriteria": [
        "[Previous] and [Next] buttons navigate suggestions",
        "Counter shows 'Suggestion X of Y'",
        "[Approve All] approves all pending suggestions",
        "[Reject All] rejects all pending suggestions",
        "Navigation updates diff view to current suggestion",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "batchNav_NavigatesPreviousNext",
        "batchNav_ShowsCounter",
        "batchNav_ApproveAllAppliesAll",
        "batchNav_RejectAllRejectsAll"
      ],
      "priority": 48,
      "passes": true,
      "notes": "Implemented BatchNavigation component with Previous/Next buttons, counter, and Approve All/Reject All actions. Integrated into SpecReviewPage. All 16 tests pass.",
      "dependencies": [
        "US-047"
      ],
      "complexity": "medium",
      "context": {}
    },
    {
      "id": "US-049",
      "title": "Implement split preview and save flow in dashboard",
      "description": "When user clicks Accept Split, show preview of all proposed split files before saving. User can review/edit each file's content in preview, then click Save All to write files.",
      "acceptanceCriteria": [
        "[Accept Split] opens preview modal with all proposed files",
        "Each file's proposed content is editable in preview",
        "[Save All] writes all files to disk",
        "[Cancel] closes preview without saving",
        "Updates parent session with splitSpecs array",
        "Creates child session files",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "splitPreview_ShowsAllFiles",
        "splitPreview_AllowsEditing",
        "splitPreview_SaveAllWritesFiles",
        "splitPreview_CancelDoesNotSave",
        "splitPreview_UpdatesParentSession"
      ],
      "priority": 49,
      "passes": true,
      "notes": "Implemented SplitPreviewModal and useSplitPreview hook with full test coverage. Added API endpoints for preview content generation and file execution with session updates.",
      "dependencies": [
        "US-040",
        "US-045"
      ],
      "complexity": "high",
      "context": {},
      "executedAt": "2026-01-11T12:31:00.925Z"
    },
    {
      "id": "US-050",
      "title": "Implement selection-based chat in dashboard",
      "description": "When user selects text in the editor and types a chat message, include the selected text as context. Agent receives selection and provides context-aware feedback.",
      "acceptanceCriteria": [
        "Selected text captured from Lexical editor",
        "Selection included in chat message to agent",
        "Agent receives { selectedText, question } format",
        "Agent provides context-aware response",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "selectionChat_CapturesSelection",
        "selectionChat_IncludesInMessage",
        "selectionChat_AgentReceivesContext"
      ],
      "priority": 50,
      "passes": true,
      "notes": "",
      "dependencies": [
        "US-041",
        "US-044"
      ],
      "complexity": "medium",
      "context": {},
      "executedAt": "2026-01-11T12:40:48.348Z"
    },
    {
      "id": "US-051",
      "title": "Implement live spec updates after approval",
      "description": "When a suggestion is approved, update the spec content in the editor live, scroll to show the change, and highlight it briefly.",
      "acceptanceCriteria": [
        "Approved changes update editor content immediately",
        "Editor scrolls to show changed section",
        "Changed section highlighted for 2 seconds",
        "Suggestion card updates to show ' Approved'",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "liveUpdate_UpdatesContent",
        "liveUpdate_ScrollsToChange",
        "liveUpdate_HighlightsFades",
        "liveUpdate_UpdatesCardStatus"
      ],
      "priority": 51,
      "passes": true,
      "notes": "Implemented status badge display in SuggestionCard component with  Approved,  Rejected,  Edited labels. Added CSS styling for status badges and completed suggestion cards. Hides action buttons when suggestion is not pending. All 4 test cases implemented in useDiffApproval.test.ts and SuggestionCard.test.tsx.",
      "dependencies": [
        "US-047"
      ],
      "complexity": "medium",
      "context": {},
      "executedAt": "2026-01-11T12:49:50.544Z"
    },
    {
      "id": "US-052",
      "title": "Implement split spec navigation in dashboard",
      "description": "When viewing a spec that has been split, show links to child specs. When viewing a child spec, show link to parent. Enable easy navigation between related specs.",
      "acceptanceCriteria": [
        "Parent spec shows 'Split into X specs' banner with links",
        "Child spec shows 'Split from: {parent}' link",
        "Clicking links navigates to related spec",
        "Session state maintained during navigation",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "splitNav_ParentShowsChildren",
        "splitNav_ChildShowsParent",
        "splitNav_LinksNavigate",
        "splitNav_SessionMaintained"
      ],
      "priority": 52,
      "passes": true,
      "notes": "Implemented split spec navigation with parent/child banners and session-maintaining navigation",
      "dependencies": [
        "US-045",
        "US-049"
      ],
      "complexity": "medium",
      "context": {},
      "executedAt": "2026-01-11T13:04:04.979Z"
    },
    {
      "id": "US-053",
      "title": "Add Spec Review to dashboard sidebar navigation",
      "description": "Add a 'Spec Review' menu item to the dashboard sidebar that navigates to the SpecReviewPage.",
      "acceptanceCriteria": [
        "'Spec Review' item appears in sidebar",
        "Clicking navigates to /spec-review route",
        "Route properly registered in dashboard router",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "sidebar_ShowsSpecReviewItem",
        "sidebar_ClickNavigates"
      ],
      "priority": 53,
      "passes": false,
      "notes": "",
      "dependencies": [
        "US-033"
      ],
      "complexity": "low",
      "context": {}
    },
    {
      "id": "US-054",
      "title": "End-to-end integration test for CLI spec review",
      "description": "Create integration tests that verify the full CLI spec review flow: file validation, review execution, result display, and exit codes.",
      "acceptanceCriteria": [
        "Test covers qala spec review with valid file",
        "Test covers file not found error",
        "Test covers timeout behavior",
        "Test covers --json output format",
        "Test covers exit codes for each verdict",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "e2e_specReview_ValidFile_CompletesSuccessfully",
        "e2e_specReview_MissingFile_ReturnsError",
        "e2e_specReview_JsonOutput_ValidJson",
        "e2e_specReview_Timeout_HandlesGracefully"
      ],
      "priority": 54,
      "passes": false,
      "notes": "",
      "dependencies": [
        "US-025"
      ],
      "complexity": "high",
      "context": {}
    },
    {
      "id": "US-055",
      "title": "End-to-end integration test for god spec detection",
      "description": "Create integration tests that verify god spec detection and splitting: detection criteria, split proposal generation, and file creation.",
      "acceptanceCriteria": [
        "Test covers god spec detection with large spec",
        "Test covers split proposal content",
        "Test covers Accept flow creating files",
        "Test covers file naming convention",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "e2e_godSpec_LargeSpec_Detected",
        "e2e_godSpec_SplitProposal_Generated",
        "e2e_godSpec_Accept_CreatesFiles",
        "e2e_godSpec_Naming_FollowsConvention"
      ],
      "priority": 55,
      "passes": false,
      "notes": "",
      "dependencies": [
        "US-020"
      ],
      "complexity": "high",
      "context": {}
    },
    {
      "id": "US-056",
      "title": "End-to-end integration test for dashboard spec review",
      "description": "Create integration tests that verify the dashboard spec review flow: split view rendering, suggestion display, diff approval, and session persistence.",
      "acceptanceCriteria": [
        "Test covers split view layout rendering",
        "Test covers suggestion card interactions",
        "Test covers diff approval flow",
        "Test covers session load/save",
        "All tests pass",
        "Build succeeds with no warnings"
      ],
      "testCases": [
        "e2e_dashboard_SplitView_Renders",
        "e2e_dashboard_Suggestions_Interactive",
        "e2e_dashboard_DiffApproval_Works",
        "e2e_dashboard_Session_Persists"
      ],
      "priority": 56,
      "passes": false,
      "notes": "",
      "dependencies": [
        "US-053"
      ],
      "complexity": "high",
      "context": {}
    }
  ]
}